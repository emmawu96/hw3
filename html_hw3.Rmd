---
  title: "US Border Patrol Apprehensions"
author: "Yin Huang, Francesco Re, Emma Yue Wu"
date: "2/11/2018"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(shiny)

# import 2017 data without sector names
library(readr)
bp17 <- read_csv("PB Apprehensions 2017.csv")[1:10,2:13]
# transpose dataset to make sectors columns
bp17 <- t(bp17)
# import sector names and make it colnames
sectors <- read_csv("PB Apprehensions 2017.csv")[,1]
sectors <- t(sectors)
colnames(bp17) <- sectors

# import 2010 data without sector names

bp10 <- read_csv("BP Apprehensions 2010.csv")[1:10,2:13]
# transpose dataset to make sectors columns
bp10 <- t(bp10)
# import sector names and make it colnames
colnames(bp10) <- sectors

as.data.frame(bp10)
bp10[,1:9]
as.data.frame(bp17)
bp17[,1:9]

```

Apprehensions at the US-Mexico border have declined to near-historic lows over the last few years. The objective of this report is to give a deeper insight on this change that is been occuring. Through the analysis of the data collected by the U.S. Customs and Border Protection through the years, we intend to shed light on the general trend's behaviour of this phenomenon, focusing on how factors such as time and place have influenced the given outcome.

## Apprehensions by Sector

Choose a year and sector to view the data.

```{r tabsets, echo=FALSE}

shinyApp(
# Define UI for dataset viewer app ----
ui <- fluidPage(
  
  # App title ----
  titlePanel("BP Apprehensions"),
  
  # Sidebar layout with input and output definitions ----
  sidebarLayout(
    
    # Sidebar panel for inputs ----
    sidebarPanel(
      
      # Input: Select a dataset ----
      selectInput("dataset", "Choose a year:",
                  choices = c("2010", "2017")),
      # Input: Select a sector ----
      selectInput("sector",
                  "Sector:",
                  choices= colnames(bp17),
                  hr()),
      
      # Include clarifying text ----
      helpText("Note: Click update button after choosing"),
      
      # Input: actionButton() to defer the rendering of output ----
      # until the user explicitly clicks the button (rather than
      # doing it immediately when inputs change). This is useful if
      # the computations required to render output are inordinately
      # time-consuming.
      actionButton("update", "Update View")
      
    ),
    
    # Main panel for displaying outputs ----
    mainPanel(
      
      # Output: Header + summary of distribution ----
      h4("Summary"),
      verbatimTextOutput("summary"),
      
      # Output: Header + table of distribution ----
      h4("Bar Plot"),
      plotOutput("distPlot")
    )
    
  )
),

# Define server logic to summarize and view selected dataset ----
server <- function(input, output) {
  
  # Return the requested dataset ----
  # Note that we use eventReactive() here, which depends on
  # input$update (the action button), so that the output is only
  # updated when the user clicks the button
  datasetInput <- eventReactive(input$update, {
    switch(input$dataset,
           "2010" = bp10,
           "2017" = bp17)
  }, ignoreNULL = FALSE)
  
  # Generate a summary of the dataset ----
  output$summary <- renderPrint({
    dataset <- datasetInput()
    summary(dataset[,input$sector])
  })
  
  # Show the first "n" observations ----
  # The use of isolate() is necessary because we don't want the table
  # to update whenever input$obs changes (only when the user clicks
  # the action button)
  output$distPlot <- renderPlot({
    
    # draw the chosen year bar plot with the specified sector
    dataset <- datasetInput()
    barplot(dataset[,input$sector], 
            main="Apprehensions by Month",
            las=2,
            ylab="Number of People")
   })
  
}
 options = list(height = 500)
)
```




